%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%Plotting beta multipliers for SF%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%plotting the residuals

clear all
close all
workdir = '/Users/fculha/Documents/git_classes/simulator_all/sim/summaries';
cd(workdir)
%iter    best obj   current obj   diff    p_home  b/educat  b/social  b/office  b/retail  b/superm  b/homepa  b/househ  walltime
M = [0,-1168.5827,-1168.5827,-65,0.01,0,61.773
1,-1071.9291,-1071.9291,-63,0.015,0,60.6919
2,-1071.9291,-1083.077,-63,0.02,0,61.3214
3,-474.4835,-474.4835,-37,0.025,0,60.2603
4,-474.4835,-524.4896,-39,0.03,0,62.8428
5,-474.4835,-521.6974,-44,0.035,0,62.5662
6,-77.7255,-77.7255,4,0.04,0,57.9767
7,-63.0558,-63.0558,28,0.045,0,56.8846
8,-63.0558,-7544.5795,192,0.05,0,62.3653
9,-63.0558,-38758.8086,448,0.055,0,65.2501
10,-63.0558,-40039.3434,468,0.06,0,66.2427
11,-63.0558,-1138.1427,-64,0.01,0.05,59.8462
12,-63.0558,-1132.8023,-64,0.015,0.05,59.1568
13,-63.0558,-705.3351,-50,0.02,0.05,63.6573
14,-63.0558,-1006.6977,-61,0.025,0.05,60.4269
15,-63.0558,-64.611,-11,0.03,0.05,58.3301
16,-61.7226,-61.7226,-8,0.035,0.05,60.3441
17,-39.3295,-39.3295,-8,0.04,0.05,59.7371
18,-39.3295,-41.7061,11,0.045,0.05,61.0237
19,-39.3295,-2147.4209,103,0.05,0.05,62.0016
20,-39.3295,-8000.1449,221,0.055,0.05,63.8436
21,-39.3295,-25536.0651,385,0.06,0.05,67.4133
22,-39.3295,-1093.6094,-63,0.01,0.1,63.8676
23,-39.3295,-1153.162,-64,0.015,0.1,71.0554
24,-39.3295,-1113.4795,-64,0.02,0.1,64.2528
25,-39.3295,-862.8899,-55,0.025,0.1,63.202
26,-39.3295,-162.4295,-20,0.03,0.1,67.1894
27,-39.3295,-47.2714,6,0.035,0.1,65.363
28,-39.3295,-466.2372,60,0.04,0.1,64.0299
29,-39.3295,-2554.996,120,0.045,0.1,63.4863
30,-39.3295,-104.1038,26,0.05,0.1,67.1525
31,-39.3295,-4591.1494,183,0.055,0.1,69.3002
32,-39.3295,-11668.1962,267,0.06,0.1,71.4686
33,-39.3295,-1128.2488,-64,0.01,0.15,63.2708
34,-39.3295,-1099.8995,-63,0.015,0.15,59.1003
35,-39.3295,-951.6402,-58,0.02,0.15,64.0823
36,-39.3295,-912.9057,-59,0.025,0.15,62.0797
37,-39.3295,-254.3098,-33,0.03,0.15,55.8372
38,-39.3295,-202.7253,-17,0.035,0.15,58.5387
39,-35.0111,-35.0111,15,0.04,0.15,57.792
40,-35.0111,-138.6249,37,0.045,0.15,63.8284
41,-35.0111,-3156.1431,134,0.05,0.15,54.1291
42,-35.0111,-2446.4242,115,0.055,0.15,50.898
43,-35.0111,-1815.3483,96,0.06,0.15,57.066
44,-35.0111,-1194.5188,-65,0.01,0.2,55.4701
45,-35.0111,-1120.0397,-64,0.015,0.2,54.4504
46,-35.0111,-1132.9755,-64,0.02,0.2,55.405
47,-35.0111,-716.146,-51,0.025,0.2,53.9937
48,-35.0111,-919.7914,-59,0.03,0.2,56.23
49,-35.0111,-314.2805,-26,0.035,0.2,58.4896
50,-35.0111,-120.1497,-6,0.04,0.2,54.1556
51,-35.0111,-204.2323,-12,0.045,0.2,53.4371
52,-35.0111,-1002.7935,83,0.05,0.2,69.3002
53,-35.0111,-5366.2091,138,0.055,0.2,64.8095
54,-35.0111,-123.2771,40,0.06,0.2,57.5909
55,-35.0111,-1103.4743,-64,0.01,0.25,55.4449
56,-35.0111,-887.6349,-58,0.015,0.25,54.8841
57,-35.0111,-1127.7351,-64,0.02,0.25,57.3985
58,-35.0111,-969.5016,-61,0.025,0.25,58.1983
59,-35.0111,-938.2526,-58,0.03,0.25,50.8504
60,-35.0111,-163.1157,-18,0.035,0.25,51.0453
61,-35.0111,-113.2661,-13,0.04,0.25,53.7696
62,-35.0111,-810.03,75,0.045,0.25,58.5249
63,-35.0111,-873.9311,69,0.05,0.25,58.24
64,-35.0111,-3676.0934,123,0.055,0.25,60.0735
65,-35.0111,-82.2489,20,0.06,0.25,59.9163
66,-35.0111,-1147.9942,-64,0.01,0.3,59.6025
67,-35.0111,-1146.0433,-64,0.015,0.3,57.152
68,-35.0111,-1083.8261,-63,0.02,0.3,53.5078
69,-35.0111,-994.8332,-61,0.025,0.3,52.7969
70,-35.0111,-792.3266,-53,0.03,0.3,52.9797
71,-35.0111,-71.9373,-11,0.035,0.3,56.6775
72,-35.0111,-51.0048,-7,0.04,0.3,56.7707
73,-35.0111,-113.3713,-17,0.045,0.3,54.7145
74,-35.0111,-1466.282,78,0.05,0.3,61.6777
75,-35.0111,-2185.622,102,0.055,0.3,59.2122
76,-35.0111,-3479.7961,158,0.06,0.3,69.8717
77,-35.0111,-1133.434,-64,0.01,0.35,52.2841
78,-35.0111,-1096.8608,-63,0.015,0.35,52.3505
79,-35.0111,-1037.9923,-62,0.02,0.35,51.6967
80,-35.0111,-931.2953,-59,0.025,0.35,57.2637
81,-35.0111,-1012.2917,-60,0.03,0.35,56.0341
82,-35.0111,-629.6037,-47,0.035,0.35,55.5952
83,-35.0111,-650.3942,66,0.04,0.35,62.1229
84,-35.0111,-66.4418,-2,0.045,0.35,61.8792
85,-35.0111,-568.8071,44,0.05,0.35,57.7691
86,-35.0111,-77.2452,23,0.055,0.35,53.3285
87,-35.0111,-404.5088,61,0.06,0.35,52.4923
88,-35.0111,-1158.3491,-65,0.01,0.4,54.1782
89,-35.0111,-1122.9451,-64,0.015,0.4,55.2911
90,-35.0111,-1153.1084,-64,0.02,0.4,55.7163
91,-35.0111,-793.5798,-54,0.025,0.4,61.3888
92,-35.0111,-568.2834,-43,0.03,0.4,66.8977
93,-35.0111,-171.8473,-26,0.035,0.4,58.652
94,-35.0111,-261.8647,-25,0.04,0.4,50.2764
95,-35.0111,-391.4157,-41,0.045,0.4,50.2828
96,-35.0111,-1506.4888,99,0.05,0.4,55.4481
97,-35.0111,-11065.8559,242,0.055,0.4,62.7348
98,-35.0111,-11379.9953,223,0.06,0.4,60.0889
99,-35.0111,-1122.7156,-64,0.01,0.45,54.1316
100,-35.0111,-1114.7956,-64,0.015,0.45,55.3468
101,-35.0111,-1163.4277,-65,0.02,0.45,52.6047
102,-35.0111,-864.1657,-58,0.025,0.45,58.6419
103,-35.0111,-882.7854,-58,0.03,0.45,49.7889
104,-35.0111,-299.4182,-36,0.035,0.45,50.279
105,-35.0111,-215.2885,-30,0.04,0.45,56.2188
106,-35.0111,-624.1814,54,0.045,0.45,56.892
107,-35.0111,-137.0839,27,0.05,0.45,55.5031
108,-35.0111,-332.8346,52,0.055,0.45,63.724
109,-35.0111,-426.178,57,0.06,0.45,57.766
110,-35.0111,-1158.2733,-65,0.01,0.5,54.5299
111,-35.0111,-1118.0652,-64,0.015,0.5,63.7426
112,-35.0111,-1062.3394,-62,0.02,0.5,57.1024
113,-35.0111,-928.94,-59,0.025,0.5,51.8197
114,-35.0111,-821.6228,-54,0.03,0.5,52.0763
115,-35.0111,-909.9784,-59,0.035,0.5,59.323
116,-17.7918,-17.7918,1,0.04,0.5,63.8512
117,-17.7918,-91.0383,-6,0.045,0.5,57.1506
118,-17.7918,-215.2946,-32,0.05,0.5,57.0284
119,-17.7918,-80.9287,14,0.055,0.5,64.2274
120,-17.7918,-196.0745,49,0.06,0.5,60.4555
121,-17.7918,-1132.8067,-64,0.01,0.55,64.4624
122,-17.7918,-1132.772,-64,0.015,0.55,64.2151
123,-17.7918,-1040.1578,-62,0.02,0.55,52.7803
124,-17.7918,-996.8401,-60,0.025,0.55,57.3304
125,-17.7918,-947.9711,-60,0.03,0.55,61.43
126,-17.7918,-897.9711,-58,0.035,0.55,73.2785
127,-17.7918,-159.6529,-29,0.04,0.55,62.4224
128,-17.7918,-63.8686,-10,0.045,0.55,55.1064
129,-17.7918,-634.3399,-42,0.05,0.55,58.0297
130,-17.7918,-2779.3082,109,0.055,0.55,58.0887
131,-17.7918,-480.0274,55,0.06,0.55,56.9164
132,-17.7918,-1168.538,-65,0.01,0.6,92.3504
133,-17.7918,-1103.2259,-63,0.015,0.6,54.8904
134,-17.7918,-986.8152,-61,0.02,0.6,55.1963
135,-17.7918,-1138.0548,-64,0.025,0.6,54.7216
136,-17.7918,-1084.4941,-63,0.03,0.6,97.9436
137,-17.7918,-1002.8554,-61,0.035,0.6,64.4074
138,-17.7918,-467.4242,-42,0.04,0.6,59.875
139,-17.7918,-205.3391,-24,0.045,0.6,51.3705
140,-17.7918,-38.1547,-6,0.05,0.6,51.986
141,-17.7918,-497.9819,46,0.055,0.6,58.1902
142,-17.7918,-283.4828,45,0.06,0.6,58.0961
143,-17.7918,-1078.9247,-63,0.01,0.65,26.8718
144,-17.7918,-1184.0727,-65,0.015,0.65,26.5059
145,-17.7918,-1148.0663,-64,0.02,0.65,26.1723
146,-17.7918,-1020.6901,-62,0.025,0.65,26.8487
147,-17.7918,-1072.7776,-63,0.03,0.65,26.5341
148,-17.7918,-924.3319,-58,0.035,0.65,26.2025
149,-17.7918,-593.0515,-45,0.04,0.65,26.604
150,-17.7918,-848.4118,-57,0.045,0.65,25.7901
151,-17.7918,-962.8918,-60,0.05,0.65,33.8296
152,-17.7918,-83.6408,-18,0.055,0.65,27.6634
153,-17.7918,-93.949,-19,0.06,0.65,27.8352
154,-17.7918,-1163.4217,-65,0.01,0.7,26.6263
155,-17.7918,-1093.9838,-63,0.015,0.7,26.3344
156,-17.7918,-1142.9409,-64,0.02,0.7,26.2348
157,-17.7918,-1112.7954,-64,0.025,0.7,25.8822
158,-17.7918,-1041.4356,-62,0.03,0.7,25.0675
159,-17.7918,-553.344,-43,0.035,0.7,25.2825
160,-17.7918,-840.4562,-58,0.04,0.7,24.9189
161,-17.7918,-348.554,-29,0.045,0.7,30.9488
162,-17.7918,-275.7722,-30,0.05,0.7,30.5111
163,-17.7918,-310.16,30,0.055,0.7,28.0783
164,-17.7918,-435.1891,41,0.06,0.7,27.8743
165,-17.7918,-1158.1872,-65,0.01,0.75,27.0802
166,-17.7918,-1104.7234,-64,0.015,0.75,27.0566
167,-17.7918,-1127.9349,-64,0.02,0.75,27.9379
168,-17.7918,-1112.9089,-64,0.025,0.75,27.7976
169,-17.7918,-1093.2122,-63,0.03,0.75,28.452
170,-17.7918,-1012.8973,-61,0.035,0.75,36.0671
171,-17.7918,-405.8473,-41,0.04,0.75,29.6155
172,-17.7918,-528.53,-44,0.045,0.75,27.3
173,-17.7918,-629.9978,-47,0.05,0.75,26.8297
174,-17.7918,-246.9146,-28,0.055,0.75,27.6076
175,-17.7918,-677.8023,-53,0.06,0.75,27.0165
176,-17.7918,-1127.886,-64,0.01,0.8,27.0456
177,-17.7918,-1148.0346,-64,0.015,0.8,27.3353
178,-17.7918,-1137.7828,-64,0.02,0.8,26.7449
179,-17.7918,-1128.0632,-64,0.025,0.8,35.7736
180,-17.7918,-981.0192,-61,0.03,0.8,28.6515
181,-17.7918,-1007.4344,-62,0.035,0.8,27.7608
182,-17.7918,-1049.4629,-62,0.04,0.8,27.4743
183,-17.7918,-838.3338,-56,0.045,0.8,27.2111
184,-17.7918,-864.0033,-58,0.05,0.8,26.8057
185,-17.7918,-35.9533,-14,0.055,0.8,27.3413
186,-17.7918,-27.3148,-4,0.06,0.8,27.1346
187,-17.7918,-1163.3598,-65,0.01,0.85,27.6237
188,-17.7918,-1107.8849,-64,0.015,0.85,35.8219
189,-17.7918,-1142.8913,-64,0.02,0.85,27.5839
190,-17.7918,-1142.9955,-64,0.025,0.85,28.5892
191,-17.7918,-847.4829,-58,0.03,0.85,27.7487
192,-17.7918,-1011.9463,-61,0.035,0.85,27.8358
193,-17.7918,-911.5656,-59,0.04,0.85,27.5221
194,-17.7918,-1014.8328,-60,0.045,0.85,28.0202
195,-17.7918,-188.0541,-26,0.05,0.85,27.85
196,-17.7918,-1049.6899,-62,0.055,0.85,28.495
197,-17.7918,-621.9695,-50,0.06,0.85,36.0541
198,-17.7918,-1158.2669,-65,0.01,0.9,26.5281
199,-17.7918,-1122.7967,-64,0.015,0.9,24.6241
200,-17.7918,-1184.0559,-65,0.02,0.9,24.4265
201,-17.7918,-1173.6565,-65,0.025,0.9,27.2151
202,-17.7918,-1021.7591,-62,0.03,0.9,26.528
203,-17.7918,-1083.9805,-63,0.035,0.9,26.1155
204,-17.7918,-760.7189,-55,0.04,0.9,24.986
205,-17.7918,-791.593,-56,0.045,0.9,27.2335
206,-17.7918,-1109.1691,-64,0.05,0.9,32.9088
207,-17.7918,-510.6463,-47,0.055,0.9,28.9031
208,-17.7918,-819.8844,-57,0.06,0.9,26.4692
209,-17.7918,-1163.48,-65,0.01,0.95,27.6456
210,-17.7918,-1153.1577,-64,0.015,0.95,28.7903
211,-17.7918,-1108.6429,-64,0.02,0.95,26.2978
212,-17.7918,-1153.3632,-64,0.025,0.95,25.5638
213,-17.7918,-1117.8333,-64,0.03,0.95,29.0154
214,-17.7918,-1019.5406,-62,0.035,0.95,28.4884
215,-17.7918,-993.5614,-61,0.04,0.95,34.1024
216,-17.7918,-1163.2824,-65,0.045,0.95,26.5786
217,-17.7918,-312.1543,-36,0.05,0.95,28.1975
218,-17.7918,-660.438,-52,0.055,0.95,27.8128
219,-17.7918,-544.2548,-44,0.06,0.95,27.5711
220,-17.7918,-1158.4935,-65,0.01,1,27.4946
221,-17.7918,-1173.7391,-65,0.015,1,27.7533
222,-17.7918,-1137.9276,-64,0.02,1,27.3903
223,-17.7918,-1122.8529,-64,0.025,1,27.7002
224,-17.7918,-1030.7367,-62,0.03,1,32.6079
225,-17.7918,-1132.8512,-64,0.035,1,27.5449
226,-17.7918,-980.367,-61,0.04,1,27.2961
227,-17.7918,-1078.5385,-63,0.045,1,27.9345
228,-17.7918,-1040.2748,-62,0.05,1,27.5948
229,-17.7918,-777.4038,-55,0.055,1,26.9711
230,-17.7918,-306.9735,-32,0.06,1,27.6813];


% sizy      = 10;
% sizx      = 10;
objective = M(:,3);
p_home    = M(:,6);
beta      = M(:,5);
% obj_mat   = reshape(objective,sizy,sizx);
% p_mat     = reshape(p_home,sizy,sizx);
% beta_mat  = reshape(beta,sizy,sizx);
% do_b      = obj_mat(2:end,:) - obj_mat(1:end-1,:);
% db        = beta_mat(2:end,:) - beta_mat(1:end-1,:);
% do_p      = obj_mat(:,2:end) - obj_mat(:,1:end-1);
% dp        = p_mat(:,2:end) - p_mat(:,1:end-1);
% 
% do_db     = do_b./db;
% do_dp     = do_p./dp;

setrangeval= [log(min(objective)) log(max(objective))];
sz = numel(objective);
newmapf = colormein(log(objective),[215,25,28; 255,255,191]./255,[255,255,191; 44,123,182]./255,[setrangeval(1) mean(setrangeval) setrangeval(end)]);
newmap = newmapf(end:-1:1,:);
color = floor(100*(setrangeval(2)-log(objective))/(setrangeval(2)-setrangeval(1)));
color(color==101) = 100;
color(color==0)   = 1;
for ii = 1:numel(color)
    objcol(ii,:) = newmap(color(ii),:);
end

Lbest = find(objective==max(objective));


% set printing options
str       = {'BayesOpt_obj'};
figname   = char(strcat(str(1)));
% figname   = 'Case3_loss';
format    = '-dpng';
resl      = '-r200';
rend      = '-opengl';
printfig  = true;


% prepare formating options
HA = {'HorizontalAlignment','left','center','right'};
VA = {'VerticalAlignment','bottom','middle','top'};
UN = {'Units','Normalized','Inches'};
TX = {'Interpreter','Latex'};
TL = {'TickLabelInterpreter','Latex'};
LW = {'LineWidth',1,1.25,1.5,2};
FS = {'FontSize',10,15,18,21,24};
MS = {'MarkerSize',6,8,12};
LS = {'LineStyle','-','--','-.',':'};
% LC = {'Color',color};

% prepare axes/borders dimensions
axh = 3*2;
axw = axh;%4.5;
ahs = 0.15;
avs = 0.15;
axb = 0.7;
axt = 0.2;
axl = 0.8;
axr = 0.5;
cbh = axh; cbw = 0.2;
fh = axb + 1*axh + 1*avs +           axt;
fw = axl + 1*axw + 1*ahs + 1.5*cbw + axr;

% initialize figure and axes
f = figure;
set(f,'Units','Inches','Position',[0.7 12 fw fh]);
set(f,'PaperPosition',[0 0 fw fh],'PaperSize',[fw fh]);
set(f,'Color','w','InvertHardcopy','off', 'MenuBar','none');
set(f,'Resize','off','Toolbar','none');
ax(1) = axes('Units','Inches','position',[axl         axb         axw axh]);
hold on
for ii = 1:numel(beta)
    hold on
     plot(beta(ii),p_home(ii),'.','Color',objcol(ii,:),'MarkerSize',35)
end
plot(beta(Lbest),p_home(Lbest),'ok','MarkerSize', 35)
xlabel('$\beta$ [1/day]',TX{:},FS{[1,4]},UN{[1,3]},'Position',[axw/2+ahs/2,-axb/2]);
ylabel('Probability of declining a travel for 2 weeks',TX{:},FS{[1,4]},UN{[1,3]},'Position',[-axl/2,axh/2]);

if printfig
    workdir = '/Users/fculha/Documents/git_classes/simulator_all/sim/plots';
      cd(workdir);
    print(f,format,resl,rend,figname,'-loose');   
end

% initialize figure and axes
str       = {'LR_beta_obj'};
figname   = char(strcat(str(1)));
f = figure;
set(f,'Units','Inches','Position',[0.7 12 fw fh]);
set(f,'PaperPosition',[0 0 fw fh],'PaperSize',[fw fh]);
set(f,'Color','w','InvertHardcopy','off', 'MenuBar','none');
set(f,'Resize','off','Toolbar','none');
ax(1) = axes('Units','Inches','position',[axl         axb         axw axh]);
plot(beta,objective,'.','MarkerSize',25)
hold on
X = [ones(length(beta),1) beta];
b = X\objective;
ycal = X*b;
mdl = fitlm(beta,objective);
R2O = mat2str(round(mdl.Rsquared.Ordinary*100)/100);
R2A = mat2str(round(mdl.Rsquared.Adjusted*100)/100);
plot(beta,ycal,'-','LineWidth',2)
str       = {'R$^2$ = ' R2O 'R$^2$ Adjusted = ' R2A};
R2   = char(strcat(str(1),str(2),str(3),str(4)));
text(.8,1,R2,UN{[1,2]},TX{:},FS{[1,4]},VA{[1,2]},HA{[1,4]},'Color',[0 0 0])

xlabel('$\beta$ [1/day]',TX{:},FS{[1,4]},UN{[1,3]},'Position',[axw/2+ahs/2,-axb/2]);
ylabel('Objective',TX{:},FS{[1,4]},UN{[1,3]},'Position',[-axl/2,axh/2]);

if printfig
    workdir = '/Users/fculha/Documents/git_classes/simulator_all/sim/plots';
      cd(workdir);
    print(f,format,resl,rend,figname,'-loose');   
end



% initialize figure and axes
str       = {'LR_p_obj'};
figname   = char(strcat(str(1)));
f = figure;
set(f,'Units','Inches','Position',[0.7 12 fw fh]);
set(f,'PaperPosition',[0 0 fw fh],'PaperSize',[fw fh]);
set(f,'Color','w','InvertHardcopy','off', 'MenuBar','none');
set(f,'Resize','off','Toolbar','none');
ax(1) = axes('Units','Inches','position',[axl         axb         axw axh]);
plot(p_home,objective,'.','MarkerSize',25)
hold on
X = [ones(length(p_home),1) p_home];
b = X\objective;
ycal = X*b;
mdl = fitlm(p_home,objective);
R2O = mat2str(round(mdl.Rsquared.Ordinary*100)/100);
R2A = mat2str(round(mdl.Rsquared.Adjusted*100)/100);
plot(p_home,ycal,'-','LineWidth',2)
str       = {'R$^2$ = ' R2O 'R$^2$ Adjusted = ' R2A};
R2   = char(strcat(str(1),str(2),str(3),str(4)));
text(.8,1,R2,UN{[1,2]},TX{:},FS{[1,4]},VA{[1,2]},HA{[1,4]},'Color',[0 0 0])


xlabel('p stay at home',TX{:},FS{[1,4]},UN{[1,3]},'Position',[axw/2+ahs/2,-axb/2]);
ylabel('Objective',TX{:},FS{[1,4]},UN{[1,3]},'Position',[-axl/2,axh/2]);

if printfig
    workdir = '/Users/fculha/Documents/git_classes/simulator_all/sim/plots';
      cd(workdir);
    print(f,format,resl,rend,figname,'-loose');   
end


